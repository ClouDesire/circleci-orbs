---
description: |
  Install a java library from a git repo
parameters:
  maven_command:
    type: string
    default: "clean install"
  maven_opts:
    type: string
    default: "-Dmaven.test.skip=true -Dmaven.javadoc.skip=true"
  maven_path:
    type: string
    default: "./mvnw"
  repo_dir:
    type: string
    default: "/tmp"
  repo_url:
    type: string
steps:
  - when:
      condition:
        not:
          equal: [ << pipeline.git.branch >>, "master" ]
      steps:
        - git_checkout:
            url: << parameters.repo_url >>
            branch: << pipeline.git.branch >>
            dir: << parameters.repo_dir >>
        - run:
            environment:
              MAVEN_COMMAND: << parameters.maven_command >>
              MAVEN_OPTS: << parameters.maven_opts >>
              MAVEN_PATH: << parameters.maven_path >>
              REPO_DIR: << parameters.repo_dir >>
              REPO_URL: << parameters.repo_url >>
            command: <<include(scripts/java_install_library.sh)>>
