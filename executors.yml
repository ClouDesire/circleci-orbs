version: "2.1"
description: "Custom executors"

executors:
  docker_java_8:
    parameters:
      java_version:
        type: string
        default: 8.0.265
      resource_class:
        type: string
        default: small
    docker:
      - image: cimg/openjdk:<< parameters.java_version >>
        auth: 
          username: $DOCKERHUB_USERNAME
          password: $DOCKERHUB_PASSWORD
    resource_class: << parameters.resource_class >>
    environment:
      MAVEN_OPTS: "-Xmx2048m -Dorg.slf4j.simpleLogger.showDateTime=true -Dorg.slf4j.simpleLogger.dateTimeFormat=HH:mm:ss.SSS"
      GIT_ROOT: "/home/circleci"
      BASE_BUILD_NUM: "0"

  docker_java_8_redis:
    parameters:
      java_version:
        type: string
        default: 8.0.265
      redis_version:
        type: string
        default: 4-alpine
      resource_class:
        type: string
        default: small
    docker:
      - image: cimg/openjdk:<< parameters.java_version >>
        auth: 
          username: $DOCKERHUB_USERNAME
          password: $DOCKERHUB_PASSWORD
      - image: redis:<< parameters.redis_version >>
        auth: 
          username: $DOCKERHUB_USERNAME
          password: $DOCKERHUB_PASSWORD
    resource_class: << parameters.resource_class >>
    environment:
      MAVEN_OPTS: "-Xmx2048m -Dorg.slf4j.simpleLogger.showDateTime=true -Dorg.slf4j.simpleLogger.dateTimeFormat=HH:mm:ss.SSS"
      GIT_ROOT: "/home/circleci"
      BASE_BUILD_NUM: "0"

  docker_java_8_postgres:
    parameters:
      java_version:
        type: string
        default: 8.0.265
      postgres_version:
        type: string
        default: 9.6.19-alpine
      postgres_database:
        type: string
        default: app
      resource_class:
        type: string
        default: small
    docker:
      - image: cimg/openjdk:<< parameters.java_version >>
        auth: 
          username: $DOCKERHUB_USERNAME
          password: $DOCKERHUB_PASSWORD
        environment:
          - POSTGRES_DB: << parameters.postgres_database >>
          - POSTGRES_USER: postgres
          - POSTGRES_PASSWORD: admin
      - image: postgres:<< parameters.postgres_version >>
        auth: 
          username: $DOCKERHUB_USERNAME
          password: $DOCKERHUB_PASSWORD 
        environment:
          - POSTGRES_DB: << parameters.postgres_database >>
          - POSTGRES_USER: postgres
          - POSTGRES_PASSWORD: admin
    resource_class: << parameters.resource_class >>
    environment:
      MAVEN_OPTS: "-Xmx2048m -Dorg.slf4j.simpleLogger.showDateTime=true -Dorg.slf4j.simpleLogger.dateTimeFormat=HH:mm:ss.SSS"
      GIT_ROOT: "/home/circleci"
      BASE_BUILD_NUM: "0"
